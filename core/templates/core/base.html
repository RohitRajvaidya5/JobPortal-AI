<!DOCTYPE html>
<html data-theme="light">
  <head>
    <title>Job Portal</title>

    <link
      href="https://cdn.jsdelivr.net/npm/daisyui@4.6.0/dist/full.css"
      rel="stylesheet"
    />
    <script src="https://cdn.tailwindcss.com"></script>
  </head>

  <body>

    <!-- NAVBAR -->
    <div class="navbar bg-neutral text-neutral-content px-4 mb-6">
      <!-- Left -->
      <div class="flex-1">
        <a href="{% url 'home' %}" class="text-xl font-bold btn btn-ghost">
          AI Job Portal
        </a>
      </div>

      <!-- Right -->
      <div class="flex-none flex items-center gap-2">

        <!-- Light / Dark Toggle -->
        <button id="themeToggle" class="btn btn-ghost btn-circle" title="Toggle theme" onclick="toggleTheme()">
          <!-- Sun (visible in light) -->
          <svg id="iconSun" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="4"></circle>
            <path d="M12 2v2"></path>
            <path d="M12 20v2"></path>
            <path d="M4.93 4.93l1.41 1.41"></path>
            <path d="M17.66 17.66l1.41 1.41"></path>
            <path d="M2 12h2"></path>
            <path d="M20 12h2"></path>
            <path d="M4.93 19.07l1.41-1.41"></path>
            <path d="M17.66 6.34l1.41-1.41"></path>
          </svg>

          <!-- Moon (visible in dark) -->
          <svg id="iconMoon" class="w-5 h-5 hidden" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"></path>
          </svg>
        </button>

        {% if user.is_authenticated %}

          <span>
            Hi
            {% if user.role == 'candidate' %}
              {{ user.candidate_profile.name }} {{ user.candidate_profile.surname }}
            {% elif user.role == 'recruiter' %}
              {{ user.recruiter_profile.name }} {{ user.recruiter_profile.surname }}
            {% else %}
              {{ user.username }}
            {% endif %}
            ({{ user.role }})
          </span>
          <a href="{% url 'logout' %}" class="btn btn-error btn-sm">
            Logout
          </a>

        {% else %}

          {% url 'login' as login_url %}
          <a
            href="{{ login_url }}"
            class="btn btn-sm {% if request.path == login_url %}btn-primary{% endif %} "
          >
            Login
          </a>

          {% url 'candidate_signup' as candidate_url %}
          <a
            href="{{ candidate_url }}"
            class="btn btn-sm {% if request.path == candidate_url %}btn-primary{% endif %}"
          >
            Candidate Signup
          </a>

          {% url 'recruiter_signup' as recruiter_url %}
          <a
            href="{{ recruiter_url }}"
            class="btn btn-sm {% if request.path == recruiter_url %}btn-primary{% endif %}"
          >
            Recruiter Signup
          </a>

        {% endif %}

      </div>
    </div>

    <!-- MAIN CONTENT -->
    <div class="container mx-auto">
      {% block content %}
      {% endblock %}
    </div>

    <script>
      // Initialize theme and icons
      function initTheme() {
        const savedTheme = localStorage.getItem('theme') || 'light';
        document.documentElement.setAttribute('data-theme', savedTheme);
        updateToggleIcon(savedTheme);
      }

      function setTheme(theme) {
        document.documentElement.setAttribute('data-theme', theme);
        localStorage.setItem('theme', theme);
        updateToggleIcon(theme);
      }

      function toggleTheme() {
        const current = document.documentElement.getAttribute('data-theme') || 'light';
        setTheme(current === 'light' ? 'dark' : 'light');
      }

      function updateToggleIcon(theme) {
        const sun = document.getElementById('iconSun');
        const moon = document.getElementById('iconMoon');
        if (!sun || !moon) return;
        if (theme === 'dark') {
          sun.classList.add('hidden');
          moon.classList.remove('hidden');
        } else {
          sun.classList.remove('hidden');
          moon.classList.add('hidden');
        }
      }

      document.addEventListener('DOMContentLoaded', initTheme);
      initTheme();
    </script>

  </body>
</html>
